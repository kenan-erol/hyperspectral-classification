<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPSC 290: HSI Drug Classification</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; margin: 20px; }
        h1, h2 { color: #333; }
        img { max-width: 100%; height: auto; border: 1px solid #ccc; margin: 10px 0; }
        pre { background-color: #f4f4f4; padding: 10px; border: 1px solid #ddd; overflow-x: auto; }
        .figure { text-align: center; margin-bottom: 20px; }
        .caption { font-style: italic; color: #555; }
    </style>
</head>
<body>

    <h1>CPSC 290: Hyperspectral Imaging to Classify Counterfeit Risk in Pharmaceuticals</h1>
    <p><strong>Student:</strong> Kenan Erol</p>
    <p><strong>Advisor:</strong> Professor Alex Wong</p>
    <p><strong>Date:</strong> Spring 2025</p>

    <hr>

    <h2>Abstract</h2>
    <p>
        Counterfeit pharmaceuticals pose a significant global health risk. These counterfeit drugs are visually indistinguishable from their real counterparts. These similarities lead people to mistakenly take ineffective or even harmful active pharmaceutical ingredients (API), potentially causing serious adverse health effects or death. 
	</p>
	<p>

		
		This work explores the potential of hyperspectral imaging (HSI), which captures detailed spectral information beyond human vision, combined with deep learning for non destructive pill analysis. HSI provides a unique spectral analysis for materials by measuring reflectance across hundreds of narrow wavelength bands. We developed a pipeline to put such HSI data through preprocessing, segmentation using Segment Anything Model 2 (SAM2), spectral patch extraction, and training of adapted Convolutional Neural Networks (CNNs). 
	</p> <p>

		
		We address two key tasks: multi-class classification of six different drug types, and binary classification distinguishing authentic spectral patches from synthetically generated “fake” patches designed to simulate the spectral differences one might expect. We used datasets acquired by a Lumo spectral imager scanning trays containing 100 pills, producing 256 bands. The drug classes used were bromazolam, ecstasy (MDMA), clonazepam, oxycodone, tramadol, and zopiclone. Our adapted ResNet-18 model achieves 100% accuracy on the drug classification task. The model achieves 98.77% accuracy on the real vs fake task when using augmentations targeted at specific bands. Augmentations to bands 0-130 and 81-130 were tried with results becoming more effective based on the strength of the augmentations. These results demonstrate the promise of HSI and deep learning for pharmaceutical analysis, while highlighting the need for further validation with physically acquired counterfeit samples.
	
    </p>

    <hr>

    <h2>Project Links</h2>
    <ul>
        <li><a href="https://github.com/kenan-erol/hyperspectral-classification" target="_blank">Code Repository</a></li>
        <li><a href="CPSC_290_Final_Report-2.pdf" target="_blank">Final Project Report (PDF)</a></li>
        <li><a href="Kenan Erol Spring 2025 Project Proposal for CPSC 290-2.pdf" target="_blank">Original Project Description (PDF)</a></li>
    </ul>



    <hr>

    <h2>Acknowledgements</h2>
    <p>I would like to express my sincere gratitude to my advisor, Professor Alex Wong, for his guidance, support, and valuable insights throughout this project. I also thank Dr. Jolene Bressi and Ian Martin from the Yale School of Public Health and Professor Simon Dunne from the Swedish National Forensic Centre for providing the HSI dataset crucial for this work. I thank Professor Holly Rushmeier for her insights into using HSI data more effectively. This research utilized the Segment Anything Model 2 (SAM2) developed by Meta AI. Computational resources were provided by the Yale Grace cluster. This project was undertaken as part of the CPSC 290 Directed Research course at Yale University under the supervision of the Director of Undergraduate Studies, Professor Theodore Kim.</p>

</body>
</html>